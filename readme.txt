This is the master branch for v2 - needs refactoring and modifications

